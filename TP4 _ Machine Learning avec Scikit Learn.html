<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        TP4 : Machine Learning avec Scikit Learn - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{background:#fff;color:#333;display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{background-color:#eaffea;color:#55a532}.hljs-deletion{background-color:#ffecec;color:#bd2c00}.hljs-link{text-decoration:underline}.markdown-body{word-wrap:break-word;font-size:16px;line-height:1.5}.markdown-body:after,.markdown-body:before{content:"";display:table}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-bottom:16px;margin-top:0}.markdown-body hr{background-color:#e7e7e7;border:0;height:.25em;margin:24px 0;padding:0}.markdown-body blockquote{border-left:.25em solid #ddd;color:#777;font-size:16px;padding:0 1em}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb;color:#555;display:inline-block;font-size:11px;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{border-bottom:1px solid #eee;padding-bottom:.3em}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{color:#777;font-size:.85em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{list-style-type:none;padding:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-bottom:0;margin-top:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:1em;font-style:italic;font-weight:700;margin-top:16px;padding:0}.markdown-body dl dd{margin-bottom:16px;padding:0 16px}.markdown-body table{display:block;overflow:auto;width:100%;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{border:1px solid #ddd;padding:6px 13px}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{background-color:#fff;box-sizing:initial;max-width:100%}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{background-color:initial;max-width:none;vertical-align:text-top}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{border:1px solid #ddd;display:block;float:left;margin:13px 0 0;overflow:hidden;padding:7px;width:auto}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{clear:both;color:#333;display:block;padding:5px 0 0}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{background-color:#0000000a;border-radius:3px;font-size:85%;margin:0;padding:.2em 0}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{content:"\00a0";letter-spacing:-.2em}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{background:#0000;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{border-radius:3px;font-size:85%;line-height:1.45;overflow:auto}.markdown-body:not(.next-editor) pre{background-color:#f7f7f7;padding:16px}.markdown-body pre code,.markdown-body pre tt{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{font-size:12px;line-height:1;overflow:hidden;padding:5px;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{background:#fff;border:0;padding:10px 8px 9px;text-align:right}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{background:#f8f8f8;border-top:0;font-weight:700}.news .alert .markdown-body blockquote{border:0;padding:0 0 0 40px}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{cursor:default!important;float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle}.markdown-body{max-width:758px;overflow:visible!important;padding-bottom:40px;padding-top:40px;position:relative}.markdown-body.next-editor{overflow-x:hidden!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{border-right:3px solid #6ce26c!important;box-sizing:initial;color:#afafaf!important;cursor:default;display:inline-block;min-width:20px;padding:0 8px 0 0;position:relative;text-align:right;z-index:4}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-bottom:none;border-left:none;border-top:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-collapse:inherit!important;border-spacing:0}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{margin-bottom:unset;overflow:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert{display:flex;flex-direction:column;gap:16px}.markdown-body .alert>*{margin:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{background-color:inherit;border-radius:0;overflow:visible;text-align:center;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{height:100%;max-width:100%}.markdown-body pre>code.wrap{word-wrap:break-word;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{background-color:#000;background-position:50%;background-repeat:no-repeat;background-size:contain;cursor:pointer;display:table;overflow:hidden;text-align:center}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{object-fit:contain;width:100%;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{height:100%;left:0;position:absolute;top:0;width:100%}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{color:#fff;height:auto;left:50%;opacity:.3;position:absolute;top:50%;transform:translate(-50%,-50%);transition:opacity .2s;width:auto;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.figma{display:table;padding-bottom:56.25%;position:relative;width:100%}.figma iframe{border:1px solid #eee;bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.markmap-container{height:300px}.markmap-container>svg{height:100%;width:100%}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{color:#777;margin:25px auto -25px;max-width:760px;position:relative;z-index:2}.toc .invisable-node{list-style-type:none}.ui-toc{bottom:20px;position:fixed;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{border-bottom-left-radius:0;border-top-left-radius:0;height:40px;padding:10px 4px}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{color:#fff;opacity:1;transition:opacity .2s}.ui-toc-label:focus{background-color:#ccc;color:#000;opacity:.3}.ui-toc-label:hover{background-color:#ccc;opacity:1;transition:opacity .2s}.ui-toc-dropdown{margin-bottom:20px;margin-top:20px;max-height:70vh;max-width:45vw;overflow:auto;padding-left:10px;padding-right:10px;text-align:inherit;width:25vw}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{letter-spacing:.0029em;padding-right:0}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{color:#767676;display:block;font-size:13px;font-weight:500;padding:4px 20px}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{background-color:initial;border-left:1px solid #000;color:#000;padding-left:19px;text-decoration:none}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{border-left:none;border-right:1px solid #000;padding-right:19px}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{background-color:initial;border-left:2px solid #000;color:#000;font-weight:700;padding-left:18px}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{border-left:none;border-right:2px solid #000;padding-right:18px}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:30px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:40px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{font-weight:500;padding-left:28px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{font-weight:500;padding-left:38px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{max-height:70vh;max-width:15vw;overflow:auto;position:fixed;top:0}.back-to-top,.expand-toggle,.go-to-bottom{color:#999;display:block;font-size:12px;font-weight:500;margin-left:10px;margin-top:10px;padding:4px 10px}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{background-position:50%;background-repeat:no-repeat;background-size:cover;border-radius:50%;display:block;height:20px;margin-bottom:2px;margin-right:5px;margin-top:2px;width:20px}.ui-user-icon.small{display:inline-block;height:18px;margin:0 0 .2em;vertical-align:middle;width:18px}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;padding-left:22px;text-decoration:none}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}.inline-spoiler-section{cursor:pointer}.inline-spoiler-section .spoiler-text{background-color:#333;border-radius:2px}.inline-spoiler-section .spoiler-text>*{opacity:0}.inline-spoiler-section .spoiler-img{filter:blur(10px)}.inline-spoiler-section.raw{background-color:#333;border-radius:2px}.inline-spoiler-section.raw>*{opacity:0}.inline-spoiler-section.unveil{cursor:auto}.inline-spoiler-section.unveil .spoiler-text{background-color:#3333331a}.inline-spoiler-section.unveil .spoiler-text>*{opacity:1}.inline-spoiler-section.unveil .spoiler-img{filter:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{color:#222;position:relative;z-index:1}.markdown-body.slides:before{background-color:currentColor;bottom:0;box-shadow:0 0 0 50vw;content:"";display:block;left:0;position:absolute;right:0;top:0;z-index:-1}.markdown-body.slides section[data-markdown]{background-color:#fff;margin-bottom:1.5em;position:relative;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{left:1em;max-height:100%;overflow:hidden;position:absolute;right:1em;top:50%;transform:translateY(-50%)}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{border:3px solid #777;content:"";height:1.5em;position:absolute;right:1em;top:-1.5em}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}svg{text-shadow:none}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-inner comment-enabled" data-hard-breaks="true" lang="fr"><h1 id="TP4--Machine-Learning-avec-Scikit-Learn" data-id="TP4--Machine-Learning-avec-Scikit-Learn"><a class="anchor hidden-xs" href="#TP4--Machine-Learning-avec-Scikit-Learn" title="TP4--Machine-Learning-avec-Scikit-Learn"><span class="octicon octicon-link"></span></a><span>TP4 : Machine Learning avec Scikit Learn</span></h1><p><strong><span>Durée :</span></strong><span> 2 séances</span><br>
<strong><span>Rendu :</span></strong><span> par email à </span><a href="mailto:vincent.drevelle.istic+IA@gmail.com" target="_blank" rel="noopener"><span>vincent.drevelle.istic+IA@gmail.com</span></a><span> (objet "IA TP4 &lt;Nom1&gt; &lt;Nom2&gt;", depuis votre adresse universitaire, avec votre/vos binôme(s) en CC:)</span><br>
<strong><span>Date limite le 28 avril 2025</span></strong></p><hr><p><span>Ces travaux pratiques se basent sur </span><a href="http://scikit-learn.org/stable/index.html" target="_blank" rel="noopener"><span>Scikit-learn</span></a><span>, une bibliothèque libre d’apprentissage automatique pour le langage Python. Elle est conçue de façon à être interopérable avec les bibliothèques de calcul numérique et scientifique </span><em><span>NumPy</span></em><span> et </span><em><span>SciPy</span></em><span>. Une connaissance approfondie de Python n’est pas nécessaire pour ce TP, mais de nombreux tutoriaux sont disponibles sur le web si vous voulez en apprendre plus.</span></p><p><span>Vous travaillerez dans un </span><a href="https://fr.wikipedia.org/wiki/Notebook_(programmation)" target="_blank" rel="noopener"><em><span>notebook</span></em></a><span>, qui vous permettra de combiner code, résultats d'exécution (affichage, graphiques) et texte formaté en </span><em><span>Markdown</span></em><span> au sein d'un même document. Ce </span><em><span>notebook</span></em><span> constituera votre rapport.</span></p><p><span>Le rendu de ce TP est dû pour le 28 avril 2025 au plus tard. Il est demandé un rapport, sous forme de notebook(s) </span><em><span>.ipynb</span></em><span>, répondant aux questions et commentaires explicitement demandés dans le sujet. Dans le rapport, dans le cas de commandes verbeuses, il est plus important d’expliquer ce que fait une commande, plutôt que de reproduire verbatim un listing de sortie trop long. Vous pouvez séparer les trois parties en trois notebooks.</span></p><p><span>L’essentiel du TP se fera à l’aide d’un jeu de données (</span><em><span>dataset</span></em><span>) d’attributs déterminés à partir d’historiques de parties de Hearthstone. On cherchera à prédire la victoire ou la défaite en fonction de l’état du jeu (points de vie, attaque, créatures, etc…). Remerciements à Clément Gautrais pour le travail sur les données.</span></p><hr><div id="install" style="background: AliceBlue">
<h2 id="Environnement-de-travail" data-id="Environnement-de-travail"><a class="anchor hidden-xs" href="#Environnement-de-travail" title="Environnement-de-travail"><span class="octicon octicon-link"></span></a><span>Environnement de travail</span></h2>
<p><span>La réalisation de ce TP nécessite un environnement </span><em><span>JupyterLab</span></em><span> permettant d'éditer et d'exécuter des notebooks en Python, avec les bibliothèques </span><em><span>Pandas</span></em><span> (gestion de jeux de données), </span><em><span>scikit-learn</span></em><span> (algorithmes d’apprentissage machine), et </span><em><span>Matplotlib</span></em><span> (visualisation).</span></p>
<p><span>Plusieurs options s'offrent à vous, suivant que vous souhaitiez travailler dans le </span><em><span>Cloud</span></em><span>, ou en local.</span></p>
<p><strong><span>JupyterLite</span></strong><span> est une solution sans installation, en local dans le navigateur (WASM). Un déploiement est accessible sur le site du projet Jupyter : </span><a href="https://jupyter.org/try-jupyter/lab/" target="_blank" rel="noopener"><span>https://jupyter.org/try-jupyter/lab/</span></a><span>. Le stockage se fait dans le navigateur. On peut ajouter des fichiers par glisser/déposer. Pensez à récupérer les fichiers créés ou modifiés dans le navigateur pour les sauver sur votre système de fichiers.</span></p>
<p><span>D'autres solutions sont détaillés dans un document annexe : </span><em><span>JupyterLite</span></em><span> (en local dans le navigateur), </span><em><span>Anaconda</span></em><span> (sur machine ISTIC ou votre PC),  environnement virtuel Python (sur votre PC), </span><em><span>Google Colab</span></em><span> (dans le </span><em><span>cloud</span></em><span>).</span></p>
</div><hr><h2 id="Exercice-1--Échauffement-avec-le-jeu-de-données-Hearthstone" data-id="Exercice-1--Échauffement-avec-le-jeu-de-données-Hearthstone"><a class="anchor hidden-xs" href="#Exercice-1--Échauffement-avec-le-jeu-de-données-Hearthstone" title="Exercice-1--Échauffement-avec-le-jeu-de-données-Hearthstone"><span class="octicon octicon-link"></span></a><span>Exercice 1 : Échauffement avec le jeu de données Hearthstone</span></h2><p><span>Nous allons utiliser un fichier d’attributs générés au cours de parties de Hearthstone. L’idée étant de déterminer, à partir de l’état de la partie courante, l’issue du combat (gagné ou perdu).</span></p><p><span>Le jeu d’attributs est contenu dans le fichier « full_dataset.csv ». À titre d’information, il a été généré à partir d’un jeu de données d’historiques de parties, disponibles sur </span><a href="https://bitbucket.org/Valnora/hsdataset/" target="_blank" rel="noopener"><span>https://bitbucket.org/Valnora/hsdataset/</span></a></p><p><span>Afin de charger et manipuler les données, nous utiliserons la bibliothèque Python « pandas ». Ce module est spécialisé dans la gestion et le traitement de jeux de données, et très utilisé dans la communauté de la science des données.</span></p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span></div><div class="code"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd  <span class="hljs-comment"># charge le module pandas et le renomme pd</span>
data = pd.read_csv(<span class="hljs-string">"full_dataset.csv"</span>)
</div></div></code></pre><p><span>L’objet « </span><code>data</code><span> » est un « dataframe » dans le jargon pandas. Pour afficher ses attributs, on peut évaluer dans une cellule :</span></p><pre><code class="python hljs">data.columns
</code></pre><p><span>(notez que </span><code>print(...)</code><span> n'est pas nécessaire, car le notebook </span><strong><span>affiche la dernière expression évaluée dans une cellule</span></strong><span>)</span></p><p><span>Une vue résumée du jeu de données peut être obtenue avec</span></p><pre><code class="python hljs">data
</code></pre><p><span>La commande help permet d’accéder à la documentation des fonctions, par exemple, pour obtenir la documentation de la fonction </span><code>len</code><span> :</span></p><pre><code class="python hljs"><span class="hljs-built_in">help</span>(<span class="hljs-built_in">len</span>) 
</code></pre><p data-original-title="" title=""><span>Évaluez les expressions suivantes, comprenez et commentez brièvement ce qu’elles font :</span></p><pre><code class="python hljs"><span class="hljs-built_in">len</span>(data)

data.columns[<span class="hljs-number">0</span>]
data.columns[<span class="hljs-number">2</span>]
data.columns[-<span class="hljs-number">1</span>] 

data.shape

data.iloc[<span class="hljs-number">0</span>]

data.iloc[<span class="hljs-number">0</span>:<span class="hljs-number">5</span>]
data.iloc[-<span class="hljs-number">5</span>:-<span class="hljs-number">1</span>]
data.iloc[<span class="hljs-number">0</span>:<span class="hljs-number">10</span>:<span class="hljs-number">3</span>]

data[<span class="hljs-string">"my_health"</span>]

data[[<span class="hljs-string">"my_health"</span>,<span class="hljs-string">"my_hand"</span>]].iloc[<span class="hljs-number">0</span>:<span class="hljs-number">5</span>]

data[<span class="hljs-string">"my_health"</span>] &gt; <span class="hljs-number">20</span>
data[<span class="hljs-string">"my_health"</span>] &gt; data[<span class="hljs-string">"opponent_health"</span>]

data[<span class="hljs-string">"my_board_nb_creatures"</span>].value_counts()

data.loc[(data[<span class="hljs-string">"my_health"</span>] &gt; data[<span class="hljs-string">"opponent_health"</span>]) &amp; (data[<span class="hljs-string">"my_board_nb_creatures"</span>] == <span class="hljs-number">2</span>)]
</code></pre><p><span>Le champ "result" du jeu de données contient l'issue du match : 0 si perdu, 1 si gagné. Le champ "turn_id" indique le numéro de tour (à partir du deuxième tour). Enfin, le champ "turns_to_end" indique combien de tours restants avant la fin de partie.</span></p><p><span>Nous allons faire l'étude en nous plaçant à un certain nombre de tours avant la fin (c'est évidement de la triche car ce nombre n'est connu que retrospectivement).</span><br>
<span>Nous allons donc filtrer le jeu de données pour ne conserver que les entrées correspondantes (ici, 4 tours avant la fin) :</span></p><pre><code class="python hljs">turns_before_end = <span class="hljs-number">4</span>   <span class="hljs-comment"># 4 tours avant la fin</span>

turn_df = data.loc[data[<span class="hljs-string">"turns_to_end"</span>]==turns_before_end]
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(turn_df))
</code></pre><p><span>Nous allons extraire les caractéristiques dans la variable X, et l'issue du match correspondant dans la variable Y :</span></p><pre><code class="python hljs">features_cols = [<span class="hljs-string">"my_health"</span>, <span class="hljs-string">"opponent_health"</span>, <span class="hljs-string">"my_hand"</span>, <span class="hljs-string">"opponent_hand"</span>, <span class="hljs-string">"my_board_nb_creatures"</span>,
     <span class="hljs-string">"my_board_total_health"</span>, <span class="hljs-string">"my_board_total_attack"</span>, <span class="hljs-string">"opponent_board_nb_creatures"</span>,
     <span class="hljs-string">"opponent_board_total_health"</span>, <span class="hljs-string">"opponent_board_total_attack"</span>, <span class="hljs-string">"me_playing"</span>]
 
pred_col = <span class="hljs-string">"result"</span>
 
X = turn_df[features_cols]
Y = turn_df[pred_col]
</code></pre><h3 id="Affichage" data-id="Affichage"><a class="anchor hidden-xs" href="#Affichage" title="Affichage"><span class="octicon octicon-link"></span></a><span>Affichage</span></h3><h4 id="Histogrammes" data-id="Histogrammes"><a class="anchor hidden-xs" href="#Histogrammes" title="Histogrammes"><span class="octicon octicon-link"></span></a><span>Histogrammes</span></h4><p><span>Commençons par afficher les histogrammes des valeurs des caractéristiques. </span><em><span>Pandas</span></em><span> fournit la méthode </span><em><span>hist</span></em><span> pour rapidement afficher des histogrammes. L'option </span><em><span>sharex</span></em><span> permet d'avoir la même plage d'abcisses sur tous les graphiques.</span></p><pre><code class="python hljs">_ = X.hist(sharex=<span class="hljs-literal">True</span>)
</code></pre><h4 id="Nuages-de-points" data-id="Nuages-de-points"><a class="anchor hidden-xs" href="#Nuages-de-points" title="Nuages-de-points"><span class="octicon octicon-link"></span></a><span>Nuages de points</span></h4><p><span>La bibliothèque </span><a href="http://matplotlib.org/" target="_blank" rel="noopener"><span>matplotlib</span></a><span> et plus particulièrement son module </span><code>matplotlib.pyplot</code><span> peut être utilisée pour visualiser les données.</span><br>
<span>Exécutez les commandes suivantes, comprenez et commentez ce qu’elles font (vous pouvez taper </span><code>help(plt.scatter)</code><span> ou rechercher sur la documentation en ligne pour plus d'informations):</span></p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt <span class="hljs-comment"># alias the name "pyplot" by "plt" </span>
 
x_col=<span class="hljs-string">"my_health"</span>
y_col=<span class="hljs-string">"opponent_health"</span>
 
plt.xlabel(x_col) <span class="hljs-comment"># all the functions defined in a given library should be prefixed by the name of the library</span>
plt.ylabel(y_col)
plt.title(<span class="hljs-string">"Hearthstone data: health"</span>)
 
plt.scatter(X[x_col], X[y_col],c=Y)  <span class="hljs-comment"># c is the named argument for marker color</span>
plt.show() 
</div></div></code></pre><p><span>On note que le choix des couleurs ne permet pas forcement de bien distinguer/identifier les classes. On recommence, en essayant de faire un peu plus explicite. Exécutez les commandes suivantes et commentez ce qu’elles font:</span></p><pre><code class="python hljs"><span class="hljs-built_in">print</span>(Y==<span class="hljs-number">0</span>)
<span class="hljs-built_in">print</span>(X.loc[Y==<span class="hljs-number">0</span>])
</code></pre><p><span>Recommencer l'affichage en remplaçant l'unique appel à scatter par</span></p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code">X_lose = X.loc[Y==<span class="hljs-number">0</span>]
X_win = X.loc[Y==<span class="hljs-number">1</span>]
plt.scatter(X_lose[x_col], X_lose[y_col], color=<span class="hljs-string">"red"</span>,label=<span class="hljs-string">"lose"</span>)
plt.scatter(X_win[x_col], X_win[y_col], color=<span class="hljs-string">"green"</span>,label=<span class="hljs-string">"win"</span>) 
plt.legend()
plt.show()
</div></div></code></pre><p><span>Pour terminer, exécutez dans une cellule le code suivant :</span></p><pre data-original-title="" title=""><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> numpy.random <span class="hljs-keyword">import</span> random
 
data = pd.read_csv(<span class="hljs-string">"full_dataset.csv"</span>)
 
features_cols = [<span class="hljs-string">"my_health"</span>, <span class="hljs-string">"opponent_health"</span>, <span class="hljs-string">"my_hand"</span>, <span class="hljs-string">"opponent_hand"</span>, <span class="hljs-string">"my_board_nb_creatures"</span>,
     <span class="hljs-string">"my_board_total_health"</span>, <span class="hljs-string">"my_board_total_attack"</span>, <span class="hljs-string">"opponent_board_nb_creatures"</span>,
     <span class="hljs-string">"opponent_board_total_health"</span>, <span class="hljs-string">"opponent_board_total_attack"</span>, <span class="hljs-string">"me_playing"</span>]
 
pred_col = <span class="hljs-string">"result"</span>
 
turns_before_end = <span class="hljs-number">4</span>
 
turn_df = data[data[<span class="hljs-string">"turns_to_end"</span>] == turns_before_end]
X = turn_df[features_cols]
Y = turn_df[pred_col]
 
x_col=<span class="hljs-string">"my_health"</span>
y_col=<span class="hljs-string">"opponent_health"</span>
 
colors=[<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>]
labels=[<span class="hljs-string">"loose"</span>, <span class="hljs-string">"win"</span>]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):
    indices = Y==i
    nb_rows = <span class="hljs-built_in">sum</span>(indices)
    plt.scatter(X.loc[indices][x_col] + <span class="hljs-number">0.5</span>*(random(nb_rows)-<span class="hljs-number">0.5</span>),
                X.loc[indices][y_col] + <span class="hljs-number">0.5</span>*(random(nb_rows)-<span class="hljs-number">0.5</span>),
                color=colors[i],label=labels[i],s=<span class="hljs-number">2</span>)
plt.legend()
plt.xlabel(x_col) 
plt.ylabel(y_col)
plt.title(<span class="hljs-string">"Hearthstone data: health"</span>) 
plt.show()
</div></div></code></pre><ul>
<li><span>À quoi sert le nombre aléatoire ajouté avec random ?</span></li>
<li><span>Cette visualisation est-elle plus informative que la précédente ?</span></li>
</ul><hr><h2 id="Exercice-2--Classification-KNN-sur-Hearthstone" data-id="Exercice-2--Classification-KNN-sur-Hearthstone"><a class="anchor hidden-xs" href="#Exercice-2--Classification-KNN-sur-Hearthstone" title="Exercice-2--Classification-KNN-sur-Hearthstone"><span class="octicon octicon-link"></span></a><span>Exercice 2 : Classification KNN sur Hearthstone</span></h2><p><span>La documentation du classificateur "k plus proches voisins" (KNN) dans scikit-learn est accessible depuis </span><a href="http://scikit-learn.org/stable/modules/neighbors.html" target="_blank" rel="noopener"><span>cette page</span></a><span>. L’algorithme KNN est implémenté dans le package </span><code>neighbors</code><span>. Dans la suite, </span><code>clf = neighbors.KNeighborsClassifier(k)</code><span> crée un objet "classificateur KNN", </span><code>clf.fit(X, Y)</code><span> utilise les données pour définir le classificateur, la commande </span><code>clf.predict</code><span> permet de classifier de nouveaux exemples et </span><code>clf.predict_proba</code><span> estime la probabilité de la classification donnée (en fonction de la proportion des classes dans les plus proches voisins). </span><code>clf.score</code><span> calcule le score global du classificateur sur un jeu de données.</span></p><p><span>Exécutez les commandes suivantes, comprenez et commentez ce qu’elles font :</span></p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> neighbors
k = <span class="hljs-number">45</span>
 
<span class="hljs-comment"># pour de l’aide taper: help(neighbors.KNeighborsClassifier)</span>
clf = neighbors.KNeighborsClassifier(k)
 
<span class="hljs-comment"># pour de l’aide taper: help(clf.fit)</span>
clf.fit(X, Y) <span class="hljs-comment">#on suppose de X et Y sont définis comme dans la partie précédente</span>
 
<span class="hljs-comment"># pour de l’aide taper: help(clf.predict) </span>
<span class="hljs-built_in">print</span>(clf.predict(X[<span class="hljs-number">0</span>:<span class="hljs-number">5</span>])) 
 
<span class="hljs-built_in">print</span>(clf.predict_proba(X[<span class="hljs-number">0</span>:<span class="hljs-number">5</span>])) 
<span class="hljs-built_in">print</span>(clf.score(X,Y)) 
</div></div></code></pre><ul>
<li><span>Essayez également avec </span><code>k=1</code><span> et avec </span><code>k=1000</code><span>. Commentez.</span></li>
</ul><p><span>Vous avez appris que le score empirique (ex : précision) obtenu sur le jeu d’apprentissage surestime le vrai score du classificateur sur des données inconnues. On a donc besoin d’un jeu de données indépendantes du jeu d’apprentissage mais générées dans les mêmes conditions, afin d’évaluer le classificateur.</span><br>
<span>On sépare donc les données en deux jeux : le jeu d’apprentissage et le jeu de test, on entraine le classificateur avec le jeu d’apprentissage et on l’évalue avec le jeu de test. Cependant, si on a peu de données, cette évaluation peut être pessimiste (expliquer pourquoi).</span><br>
<span>Scikit learn propose un module </span><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" target="_blank" rel="noopener"><span>model selection</span></a><span> qui permet de séparer un jeu de données en jeux d’apprentissage et de test (en utilisant </span><code>model_selection.train_test_split</code><span>). Le module </span><a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics" target="_blank" rel="noopener"><span>metrics</span></a><span> fournit de nombreux critères d’évaluation pour votre classificateur.</span></p><p><span>Exécutez les commandes suivantes, et comprenez (et écrivez dans votre rapport) ce qu’elles font :</span></p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split 
<span class="hljs-comment"># pour de l’aide taper: help(train_test_split)</span>

X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=<span class="hljs-number">0.3</span>) 
 
<span class="hljs-built_in">len</span>(X_train)
<span class="hljs-built_in">len</span>(X_test) 
<span class="hljs-built_in">len</span>(X_train[Y_train==<span class="hljs-number">0</span>])
<span class="hljs-built_in">len</span>(X_train[Y_train==<span class="hljs-number">1</span>])

k = <span class="hljs-number">45</span>
clf = neighbors.KNeighborsClassifier(k)
clf.fit(X_train, Y_train)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"score:"</span>, clf.score(X,Y))

Y_pred = clf.predict(X_test) 
 
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
cm = confusion_matrix(Y_test, Y_pred)
<span class="hljs-built_in">print</span>(cm)
</div></div></code></pre><ul>
<li><span>Faire l'expérience pour k=1, 45 et 1000 et comparer avec l'exercice précédent.</span></li>
<li><span>Expliquer en quelques lignes ce qu'on voit (en général) dans une matrice de confusion.</span></li>
</ul><p><span>On voit que k a une influence sur la précision de notre classificateur. Nous allons chercher à choisir la meilleure valeur pour k. En général, les hyper-parametres sont ajustés en utilisant la validation croisée. Le module </span><code>model_selection</code><span> fournit la fonction </span><code>KFold</code><span> qui sépare le dataset original X en </span><code>n_split</code><span> parties qui sont des couples (jeu d’apprentissage, jeu de test).</span></p><p><span>Exécutez les commandes suivantes :</span></p><pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> KFold
kf=KFold(n_splits=<span class="hljs-number">10</span>,shuffle=<span class="hljs-literal">True</span>)
<span class="hljs-keyword">for</span> learn,test <span class="hljs-keyword">in</span> kf.split(X):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"app : "</span>,learn,<span class="hljs-string">" test "</span>,test)
</code></pre><ul>
<li><span>Réessayer avec le paramètre shuffle=False. Que se passe-t-il ? Quel est l'intéret du shuffle ? Est-il nécessaire sur nos données ?</span></li>
</ul><p><span>Étudier et exécuter le programme suivant :</span></p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt
 
data = pd.read_csv(<span class="hljs-string">"full_dataset.csv"</span>)
 
features_cols = [<span class="hljs-string">"my_health"</span>, <span class="hljs-string">"opponent_health"</span>, <span class="hljs-string">"my_hand"</span>, <span class="hljs-string">"opponent_hand"</span>, <span class="hljs-string">"my_board_nb_creatures"</span>,
     <span class="hljs-string">"my_board_total_health"</span>, <span class="hljs-string">"my_board_total_attack"</span>, <span class="hljs-string">"opponent_board_nb_creatures"</span>,
     <span class="hljs-string">"opponent_board_total_health"</span>, <span class="hljs-string">"opponent_board_total_attack"</span>, <span class="hljs-string">"me_playing"</span>]
pred_col = <span class="hljs-string">"result"</span>
 
turns_before_end = <span class="hljs-number">4</span>
turn_df = data[data[<span class="hljs-string">"turns_to_end"</span>] == turns_before_end]
X = turn_df[features_cols]
Y = turn_df[pred_col]
 
<span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> neighbors
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> KFold
kf=KFold(n_splits=<span class="hljs-number">10</span>,shuffle=<span class="hljs-literal">True</span>)
scores=[]
k_values = <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>,<span class="hljs-number">1</span>)
<span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> k_values:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Computing... %d %%"</span>%(<span class="hljs-built_in">int</span>(<span class="hljs-number">100</span>*(k-k_values[<span class="hljs-number">0</span>])/k_values[-<span class="hljs-number">1</span>])), end=<span class="hljs-string">'\r'</span>)
    score=<span class="hljs-number">0</span>
    clf = neighbors.KNeighborsClassifier(k)
    <span class="hljs-keyword">for</span> learn,test <span class="hljs-keyword">in</span> kf.split(X):
        X_train=X.iloc[learn]
        Y_train=Y.iloc[learn]
        clf.fit(X_train, Y_train)
        X_test=X.iloc[test]
        Y_test=Y.iloc[test]
        score += clf.score(X_test,Y_test) / kf.n_splits
    scores.append(score)

best_score, best_k = <span class="hljs-built_in">max</span>([(v, k_values[i]) <span class="hljs-keyword">for</span> (i,v) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(scores)])
<span class="hljs-built_in">print</span>(<span class="hljs-string">"best k:"</span>,best_k, <span class="hljs-string">" score="</span>,best_score)
plt.plot(k_values, scores)
plt.xlabel(<span class="hljs-string">"k"</span>) 
plt.ylabel(<span class="hljs-string">"score"</span>)
plt.plot(best_k, best_score, <span class="hljs-string">'or'</span>)
plt.plot([<span class="hljs-number">0</span>,best_k,best_k], [best_score,best_score,<span class="hljs-built_in">min</span>(scores)], <span class="hljs-string">':r'</span>)
plt.show()
</div></div></code></pre><ul>
<li><span>Commentez le résultat de l'exécution du programme.</span></li>
<li><span>Exécutez le avec des valeurs de k dans </span><code>range(1,1800,20)</code><span>. Expliquez l'allure de la courbe.</span></li>
</ul><h3 id="Un-problème-" data-id="Un-problème-"><a class="anchor hidden-xs" href="#Un-problème-" title="Un-problème-"><span class="octicon octicon-link"></span></a><span>Un problème </span><span class="smartypants">???</span></h3><p><span>Observez de nouveau les histogrammes de l'Exercice 1. Qu'a-t-on négligé de faire avant d'utiliser la classification par KNN ? Quel est l'impact de cet oubli ?</span><br>
<span>Dans une nouvelle cellule, reprenrz le programme précéent et instanciez y l'objet</span></p><pre><code class="python hljs">scaler = sklearn.preprocessing.StandardScaler()
</code></pre><p><span>Utlisez les méthodes </span><code>scaler.fit_transform</code><span> et </span><code>scaler.transform</code><span> afin de traiter les données d'entraînement et de test dans la boucle d'évaluation. Attention, les données de test ne doivent pas être utilisées pour déterminer les paramètres du prétraitement.</span></p><p><span>Quel est l'impact de ce pré-traitement des données ?</span></p><h3 id="Aller-plus-loin-bonus" data-id="Aller-plus-loin-bonus"><a class="anchor hidden-xs" href="#Aller-plus-loin-bonus" title="Aller-plus-loin-bonus"><span class="octicon octicon-link"></span></a><span>Aller plus loin (bonus)</span></h3><p><span>Il y a une autre caractéristique du jeu de données que l'on a négligée. Evaluez les commandes suivantes :</span></p><pre><code class="python hljs">data[<span class="hljs-string">'result'</span>].value_counts()
</code></pre><pre><code class="python hljs">turn_df[<span class="hljs-string">'result'</span>].value_counts()
</code></pre><p><span>Le jeu de données est il un échantillon représentatif de toutes les parties de Hearthstone ? Quel est l'influence sur la prédiction du classificateur ?</span><br>
<span>Vous pouvez tenter de redresser les données en réalisant un échatillonnage stratifié. Utilisez </span><em><span>.groupby(</span><span class="smartypants">…</span><span>)</span></em><span>, et </span><em><span>.sample(</span><span class="smartypants">…</span><span>)</span></em><span> pour ce faire.</span></p><hr><h2 id="Exercice-3--Régression-linéaire" data-id="Exercice-3--Régression-linéaire"><a class="anchor hidden-xs" href="#Exercice-3--Régression-linéaire" title="Exercice-3--Régression-linéaire"><span class="octicon octicon-link"></span></a><span>Exercice 3 : Régression linéaire</span></h2><p><span>Dans cet exercice, nous allons utiliser les mêmes observations que dans l'exercice 2, mais pour essayer de prédire le nombre de tours restants avant la fin d'une partie d'Hearthstone.</span></p><p><span>On choisit de faire la prédiction en se plaçant au dixième tour de jeu :</span></p><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
 
data = pd.read_csv(<span class="hljs-string">"full_dataset.csv"</span>)
 
features_cols = [<span class="hljs-string">"my_health"</span>, <span class="hljs-string">"opponent_health"</span>, <span class="hljs-string">"my_hand"</span>, <span class="hljs-string">"opponent_hand"</span>, <span class="hljs-string">"my_board_nb_creatures"</span>,
     <span class="hljs-string">"my_board_total_health"</span>, <span class="hljs-string">"my_board_total_attack"</span>, <span class="hljs-string">"opponent_board_nb_creatures"</span>,
     <span class="hljs-string">"opponent_board_total_health"</span>, <span class="hljs-string">"opponent_board_total_attack"</span>]
 
pred_col = <span class="hljs-string">"turns_to_end"</span>
 
current_turn = <span class="hljs-number">10</span>
 
turn_df = data[data[<span class="hljs-string">"turn_id"</span>] == current_turn]
X = turn_df[features_cols]
Y = turn_df[pred_col]

<span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(X))
</div></div></code></pre><ol>
<li><span>Séparer le jeu de données en un jeu d'entraînement et un jeu de test (utiliser </span><code>train_test_split</code><span> comme dans l'exercice 2).</span></li>
<li><span>Scikit Learn implémente la régression linéaire aux moindres carrés dans la classe </span><code>linear_model.LinearRegression()</code><span>.</span></li>
</ol><p><span>Calcul des paramètres du modèle linéaire de regression :</span></p><pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> linear_model 
lr = linear_model.LinearRegression()
lr.fit(X_train, Y_train)
</code></pre><ol start="3">
<li><span>Il faut évaluer le modèle sur le jeu de test.</span></li>
</ol><ul>
<li><span>Calculer la prédiction </span><code>Y_pred</code><span> sur le jeu de test.</span></li>
<li><span>Scikit Learn fournit de nombreuses métriques pour l'évaluation, on utilisera </span><code>mean_squared_error</code><span> pour calculer l'erreur quadratique moyenne (MSE) de la prédiction. Consultez la documentation pour vous servir de la fonction, accessible via l'import suivant :</span></li>
</ul><pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> mean_squared_error
</code></pre><ul>
<li><span>Quelle est la particularité du critère MSE pour la régression linéaire aux moindres carrés ?</span></li>
<li><span>Vous pouvez également calculer d'autres métriques telles que l'erreur absolue moyenne (MAE) </span><code>mean_absolute_error</code><span>, ou l'erreur absolue médiane </span><code>median_absolute_error</code><span>.</span></li>
</ul><ol start="4">
<li><span>Visualiser l'erreur de prédiction</span></li>
</ol><pre><code class="python hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-keyword">from</span> numpy.random <span class="hljs-keyword">import</span> random
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt

plt.scatter(Y_test + <span class="hljs-number">0.3</span>*(random(<span class="hljs-built_in">len</span>(Y_test))-<span class="hljs-number">0.5</span>), Y_pred, color=<span class="hljs-string">'black'</span>, s=<span class="hljs-number">1</span>)

plt.plot([<span class="hljs-number">0</span>,<span class="hljs-number">20</span>], [<span class="hljs-number">0</span>,<span class="hljs-number">20</span>], <span class="hljs-string">'--b'</span>)
plt.xlabel(<span class="hljs-string">"True Y"</span>) 
plt.ylabel(<span class="hljs-string">"Prediction"</span>)
</div></div></code></pre><ul>
<li><span>Que représente la ligne bleue en pointillés ?</span></li>
<li><span>Qu'aprend-t-on sur le modèle en étudiant la figure ?</span></li>
</ul><ol start="5">
<li><span>Ce modèle de prédiction vous paraît-il performant ? Quelles sont les raisons qui peuvent expliquer les erreurs de prédiction ?</span></li>
<li><span>Essayez d'améliorer la prédiction en changeant les caractéristiques choisies, et/ou en créant de nouvelles caractristiques. Vous pouvez aussi essayer d'autres méthodes de regression de scikit-learn.</span></li>
</ol></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li><a href="#TP4--Machine-Learning-avec-Scikit-Learn" title="TP4 : Machine Learning avec Scikit Learn">TP4 : Machine Learning avec Scikit Learn</a><ul class="nav">
<li><a href="#Exercice-1--Échauffement-avec-le-jeu-de-données-Hearthstone" title="Exercice 1 : Échauffement avec le jeu de données Hearthstone">Exercice 1 : Échauffement avec le jeu de données Hearthstone</a><ul class="nav">
<li><a href="#Affichage" title="Affichage">Affichage</a></li>
</ul>
</li>
<li><a href="#Exercice-2--Classification-KNN-sur-Hearthstone" title="Exercice 2 : Classification KNN sur Hearthstone">Exercice 2 : Classification KNN sur Hearthstone</a><ul class="nav">
<li><a href="#Un-problème-" title="Un problème ???">Un problème ???</a></li>
<li><a href="#Aller-plus-loin-bonus" title="Aller plus loin (bonus)">Aller plus loin (bonus)</a></li>
</ul>
</li>
<li><a href="#Exercice-3--Régression-linéaire" title="Exercice 3 : Régression linéaire">Exercice 3 : Régression linéaire</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" lang="fr" >
        <div class="toc"><ul class="nav">
<li><a href="#TP4--Machine-Learning-avec-Scikit-Learn" title="TP4 : Machine Learning avec Scikit Learn">TP4 : Machine Learning avec Scikit Learn</a><ul class="nav">
<li><a href="#Exercice-1--Échauffement-avec-le-jeu-de-données-Hearthstone" title="Exercice 1 : Échauffement avec le jeu de données Hearthstone">Exercice 1 : Échauffement avec le jeu de données Hearthstone</a><ul class="nav">
<li><a href="#Affichage" title="Affichage">Affichage</a></li>
</ul>
</li>
<li><a href="#Exercice-2--Classification-KNN-sur-Hearthstone" title="Exercice 2 : Classification KNN sur Hearthstone">Exercice 2 : Classification KNN sur Hearthstone</a><ul class="nav">
<li><a href="#Un-problème-" title="Un problème ???">Un problème ???</a></li>
<li><a href="#Aller-plus-loin-bonus" title="Aller plus loin (bonus)">Aller plus loin (bonus)</a></li>
</ul>
</li>
<li><a href="#Exercice-3--Régression-linéaire" title="Exercice 3 : Régression linéaire">Exercice 3 : Régression linéaire</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
